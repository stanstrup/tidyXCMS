<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create Tidy Long-Format Peak Table with Optional Annotations — tidy_peaklist • tidyXCMS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create Tidy Long-Format Peak Table with Optional Annotations — tidy_peaklist"><meta name="description" content="Generates a comprehensive long-format peak table where each row represents
one feature for one sample. Optionally includes CAMERA annotations for isotopes,
adducts, and pseudospectrum groups if provided."><meta property="og:description" content="Generates a comprehensive long-format peak table where each row represents
one feature for one sample. Optionally includes CAMERA annotations for isotopes,
adducts, and pseudospectrum groups if provided."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidyXCMS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.30</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/long-format-peaklist.html">Creating Long-Format Peak Tables</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/stanstrup/tidyXCMS" aria-label="GitHub repository"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create Tidy Long-Format Peak Table with Optional Annotations</h1>
      <small class="dont-index">Source: <a href="https://github.com/stanstrup/tidyXCMS/blob/main/R/tidy_peaklist.R" class="external-link"><code>R/tidy_peaklist.R</code></a></small>
      <div class="d-none name"><code>tidy_peaklist.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates a comprehensive long-format peak table where each row represents
one feature for one sample. Optionally includes CAMERA annotations for isotopes,
adducts, and pseudospectrum groups if provided.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tidy_peaklist</span><span class="op">(</span><span class="va">x</span>, xsAnnotate <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An <a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html" class="external-link">xcms::XCMSnExp</a> or <a href="https://rdrr.io/pkg/xcms/man/XcmsExperiment.html" class="external-link">xcms::XcmsExperiment</a>
object containing peak detection results. Feature grouping (via
<code><a href="https://rdrr.io/pkg/xcms/man/groupChromPeaks.html" class="external-link">xcms::groupChromPeaks()</a></code>) is optional but recommended.</p></dd>


<dt id="arg-xsannotate">xsAnnotate<a class="anchor" aria-label="anchor" href="#arg-xsannotate"></a></dt>
<dd><p>Optional. An <code>xsAnnotate</code> object from the CAMERA package
containing peak annotations (isotopes, adducts, pseudospectrum groups).
If NULL (default), annotation columns will not be included in the output.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble::tibble</a> in long format with one row per feature per sample
(or one row per peak per sample if features are not defined).
The tibble contains the following columns with their data types:</p><dl><dt>feature_id</dt>
<dd><p>integer: Feature identifier (1, 2, 3, ...). Only present
when features are defined via <code><a href="https://rdrr.io/pkg/xcms/man/groupChromPeaks.html" class="external-link">xcms::groupChromPeaks()</a></code>.</p></dd>

<dt>f_mzmed, f_mzmin, f_mzmax</dt>
<dd><p>numeric: Feature-level m/z statistics
(median, minimum, maximum). Only present when features are defined.</p></dd>

<dt>f_rtmed, f_rtmin, f_rtmax</dt>
<dd><p>numeric: Feature-level retention time
statistics in seconds (median, minimum, maximum). Only present when
features are defined.</p></dd>

<dt>ms_level</dt>
<dd><p>integer: MS level (typically 1 for MS1 features). Only
present when features are defined.</p></dd>

<dt>isotopes</dt>
<dd><p>character: Isotope annotations from CAMERA (e.g., "<code>"[M]+"</code>",
"<code>"[M+1]+"</code>"). Only present when xsAnnotate is provided.</p></dd>

<dt>adduct</dt>
<dd><p>character: Adduct annotations from CAMERA (e.g., "<code>"[M+H]+"</code>",
"<code>"[M+Na]+"</code>"). Only present when xsAnnotate is provided.</p></dd>

<dt>pcgroup</dt>
<dd><p>integer: Pseudospectrum group ID from CAMERA. Features with
the same pcgroup are believed to originate from the same compound. Only
present when xsAnnotate is provided.</p></dd>

<dt>feature_group</dt>
<dd><p>character: Feature group identifier from
<code><a href="https://rdrr.io/pkg/MsFeatures/man/groupFeatures.html" class="external-link">MsFeatures::groupFeatures()</a></code> (e.g., "FG.001", "FG.002"). Only present
if groupFeatures was applied.</p></dd>

<dt>mz, mzmin, mzmax</dt>
<dd><p>numeric: Peak m/z values (centroid, minimum, maximum).</p></dd>

<dt>rt, rtmin, rtmax</dt>
<dd><p>numeric: Peak retention time in seconds (apex, minimum,
maximum).</p></dd>

<dt>into</dt>
<dd><p>numeric: Integrated peak intensity (integrated area of original
(raw) peak).</p></dd>

<dt>intb</dt>
<dd><p>numeric: Baseline-corrected integrated peak intensity.</p></dd>

<dt>maxo</dt>
<dd><p>numeric: Maximum peak intensity (apex).</p></dd>

<dt>sn</dt>
<dd><p>numeric: Signal-to-noise ratio.</p></dd>

<dt>is_filled</dt>
<dd><p>logical: Whether the peak was gap-filled (TRUE) or originally
detected (FALSE).</p></dd>

<dt>filepath</dt>
<dd><p>character: Full file path to the raw data file.</p></dd>

<dt>filename</dt>
<dd><p>character: Basename of the raw data file.</p></dd>

<dt>fromFile</dt>
<dd><p>numeric: Sample index (1-based) corresponding to the order
in <a href="https://rdrr.io/pkg/xcms/man/XcmsExperiment.html" class="external-link">xcms::fileNames,MsExperiment-method</a>.</p></dd>

<dt>peakidx</dt>
<dd><p>numeric: Internal peak index from <code><a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html" class="external-link">xcms::chromPeaks()</a></code>.</p></dd>

<dt>Additional columns</dt>
<dd><p>Variable types: Any columns from <code><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html" class="external-link">Biobase::pData()</a></code>
or <code><a href="https://rdrr.io/pkg/MsExperiment/man/MsExperiment.html" class="external-link">MsExperiment::sampleData()</a></code> are included with their original data types.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function integrates data from multiple sources:</p><ul><li><p>Chromatographic peaks from <code><a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html" class="external-link">xcms::chromPeaks()</a></code></p></li>
<li><p>Feature definitions from <code><a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html" class="external-link">xcms::featureDefinitions()</a></code> (if available)</p></li>
<li><p>Feature intensities from <code><a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-peak-grouping-results.html" class="external-link">xcms::featureValues()</a></code> (if features defined)</p></li>
<li><p>CAMERA annotations from the xsAnnotate object (if provided)</p></li>
<li><p>Sample metadata from <code><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html" class="external-link">Biobase::pData()</a></code> or <code><a href="https://rdrr.io/pkg/MsExperiment/man/MsExperiment.html" class="external-link">MsExperiment::sampleData()</a></code></p></li>
</ul><p>The function supports both <a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html" class="external-link">xcms::XCMSnExp</a> and <a href="https://rdrr.io/pkg/xcms/man/XcmsExperiment.html" class="external-link">xcms::XcmsExperiment</a>
objects, providing flexibility for modern XCMS workflows.</p>
<p><strong>Feature grouping is optional</strong>: If <code><a href="https://rdrr.io/pkg/xcms/man/groupChromPeaks.html" class="external-link">xcms::groupChromPeaks()</a></code> has not been run,
the function will return peak-level data only, without feature-level aggregation.</p>
<p><strong>Intensity matching</strong>: When multiple peaks from the same sample are assigned to
a single feature, XCMS has a parameter (method = "maxint") that selects which
peak intensity to use. This function filters peaks to match the intensity values
that XCMS selected, ensuring consistency with XCMS's feature intensity matrix.</p>
<p>Missing values (NA) indicate that a feature was not detected in a particular
sample.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>

<ul><li><p>XCMS sometimes creates duplicate peaks; this function keeps only the
first occurrence.</p></li>
<li><p>The function uses "maxint" method for feature values, meaning it
takes the maximum intensity peak for each feature in each sample.</p></li>
<li><p>CAMERA annotations are optional. If xsAnnotate is NULL, the isotopes,
adduct, and pcgroup columns will not be present in the output.</p></li>
<li><p>MsFeatures grouping is automatically detected. If <code><a href="https://rdrr.io/pkg/MsFeatures/man/groupFeatures.html" class="external-link">MsFeatures::groupFeatures()</a></code>
was applied to the object, the feature_group column will be included in the output.</p></li>
<li><p>For XcmsExperiment objects, sample metadata is accessed via sampleData()
instead of pData().</p></li>
<li><p>For large datasets (many features x many samples), the output can be
memory-intensive. A warning is issued if the expected output exceeds 10 million rows.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sneumann/xcms" class="external-link">xcms</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: BiocParallel</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This is xcms version 4.8.0 </span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load example data</span></span></span>
<span class="r-in"><span><span class="va">faahko_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/loadXcmsData.html" class="external-link">loadXcmsData</a></span><span class="op">(</span><span class="st">"faahko_sub"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Peak detection</span></span></span>
<span class="r-in"><span><span class="va">cwp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/findChromPeaks-centWave.html" class="external-link">CentWaveParam</a></span><span class="op">(</span>peakwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">80</span><span class="op">)</span>, noise <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/findChromPeaks.html" class="external-link">findChromPeaks</a></span><span class="op">(</span><span class="va">faahko_sub</span>, param <span class="op">=</span> <span class="va">cwp</span>, BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed previously identified chromatographic peaks.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Detecting mass traces at 25 ppm ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OK</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Detecting chromatographic peaks in 2075 regions of interest ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  OK: 561 found.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Detecting mass traces at 25 ppm ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OK</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Detecting chromatographic peaks in 2308 regions of interest ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  OK: 741 found.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Detecting mass traces at 25 ppm ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OK</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Detecting chromatographic peaks in 2081 regions of interest ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  OK: 448 found.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Peak grouping</span></span></span>
<span class="r-in"><span><span class="va">pdp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/groupChromPeaks.html" class="external-link">PeakDensityParam</a></span><span class="op">(</span>sampleGroups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">fileNames</span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        minFraction <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/groupChromPeaks.html" class="external-link">groupChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, param <span class="op">=</span> <span class="va">pdp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Without CAMERA annotations</span></span></span>
<span class="r-in"><span><span class="va">peak_table_no_camera</span> <span class="op">&lt;-</span> <span class="fu">tidy_peaklist</span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">peak_table_no_camera</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 24</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sampleNames fromFile feature_id f_mzmed f_mzmin f_mzmax f_rtmed f_rtmin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> ko15.CDF           1          1    205     205     205    <span style="text-decoration: underline;">2</span>788.   <span style="text-decoration: underline;">2</span>785.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> ko15.CDF           1          2    206     206     206    <span style="text-decoration: underline;">2</span>785.   <span style="text-decoration: underline;">2</span>783.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> ko15.CDF           1          3    207.    207.    207.   <span style="text-decoration: underline;">2</span>713.   <span style="text-decoration: underline;">2</span>711.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> ko15.CDF           1          4    233     233     233    <span style="text-decoration: underline;">3</span>025.   <span style="text-decoration: underline;">3</span>024.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> ko15.CDF           1          5    233.    233.    233.   <span style="text-decoration: underline;">3</span>016.   <span style="text-decoration: underline;">3</span>015.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> ko15.CDF           1          6    240.    240.    240.   <span style="text-decoration: underline;">3</span>677.   <span style="text-decoration: underline;">3</span>675.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 16 more variables: f_rtmax &lt;dbl&gt;, ms_level &lt;int&gt;, filepath &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   filename &lt;chr&gt;, peakidx &lt;dbl&gt;, mz &lt;dbl&gt;, mzmin &lt;dbl&gt;, mzmax &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   rt &lt;dbl&gt;, rtmin &lt;dbl&gt;, rtmax &lt;dbl&gt;, into &lt;dbl&gt;, intb &lt;dbl&gt;, maxo &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   sn &lt;dbl&gt;, is_filled &lt;lgl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: With CAMERA annotations</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://msbi.ipb-halle.de/msbi/CAMERA/" class="external-link">CAMERA</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">commonMZ</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Convert to xcmsSet for CAMERA (CAMERA requires the old xcmsSet class)</span></span></span>
<span class="r-in"><span><span class="va">xset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">xdata</span>, <span class="st">"xcmsSet"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: you might want to set/adjust the 'sampclass' of the returned xcmSet object before proceeding with the analysis.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># CAMERA annotation</span></span></span>
<span class="r-in"><span><span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CAMERA/man/xsAnnotate.html" class="external-link">xsAnnotate</a></span><span class="op">(</span><span class="va">xset</span>, polarity <span class="op">=</span> <span class="st">"positive"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CAMERA/man/groupFWHM-methods.html" class="external-link">groupFWHM</a></span><span class="op">(</span><span class="va">xs</span>, perfwhm <span class="op">=</span> <span class="fl">0.1</span>, intval <span class="op">=</span> <span class="st">"into"</span>, sigma <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Start grouping after retention time.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Created 227 pseudospectra.</span>
<span class="r-in"><span><span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CAMERA/man/findIsotopes-methods.html" class="external-link">findIsotopes</a></span><span class="op">(</span><span class="va">xs</span>, ppm <span class="op">=</span> <span class="fl">10</span>, mzabs <span class="op">=</span> <span class="fl">0.01</span>, intval <span class="op">=</span> <span class="st">"into"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generating peak matrix!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Run isotope peak annotation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  % finished: 10  20  30  40  50  60  70  80  90  100  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Found isotopes: 23 </span>
<span class="r-in"><span><span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CAMERA/man/groupCorr-methods.html" class="external-link">groupCorr</a></span><span class="op">(</span><span class="va">xs</span>, calcIso <span class="op">=</span> <span class="cn">FALSE</span>, calcCiS <span class="op">=</span> <span class="cn">TRUE</span>, calcCaS <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                cor_eic_th <span class="op">=</span> <span class="fl">0.7</span>, pval <span class="op">=</span> <span class="fl">1E-6</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Start grouping after correlation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generating EIC's .. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Warning: Found NA peaks in selected sample.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating peak correlations in 227 Groups... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  % finished: 10  20  30  40  50  60  70  80  90  100  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating graph cross linking in 227 Groups... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  % finished: 10  20  30  40  50  60  70  80  90  100  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> New number of ps-groups:  280 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> xsAnnotate has now 280 groups, instead of 227 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get adduct/fragment rules from commonMZ</span></span></span>
<span class="r-in"><span><span class="va">rules_pos</span> <span class="op">&lt;-</span> <span class="fu">commonMZ</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/commonMZ/man/MZ_CAMERA.html" class="external-link">MZ_CAMERA</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"pos"</span>, warn_clash <span class="op">=</span> <span class="cn">TRUE</span>, clash_ppm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The following adducts/fragments seem to collide. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   first       second                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> [M+H-NH3]+  [M+NH4]+                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> [M+H-C3H4]+ [M+H+(CH3)2CO-H2O]+ (acetone cond.)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Consider removing one of them. Example: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rules=rules[            !grepl("[M+NH4]+",rules[,"name"],fixed=TRUE)         ,]</span>
<span class="r-in"><span><span class="va">rules_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">rules_pos</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find adducts using the rules</span></span></span>
<span class="r-in"><span><span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CAMERA/man/findAdducts-methods.html" class="external-link">findAdducts</a></span><span class="op">(</span><span class="va">xs</span>, ppm <span class="op">=</span> <span class="fl">10</span>, mzabs <span class="op">=</span> <span class="fl">0.01</span>, multiplier <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                  polarity <span class="op">=</span> <span class="st">"positive"</span>, rules <span class="op">=</span> <span class="va">rules_pos</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generating peak matrix for peak annotation!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polarity is set in xsAnnotate: positive </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Found and use user-defined ruleset!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating possible adducts in 280 Groups... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  % finished: 10  20  30  40  50  60  70  80  90  100  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create long-format peak table</span></span></span>
<span class="r-in"><span><span class="va">peak_table</span> <span class="op">&lt;-</span> <span class="fu">tidy_peaklist</span><span class="op">(</span><span class="va">xdata</span>, <span class="va">xs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">peak_table</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 27</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sampleNames fromFile feature_id f_mzmed f_mzmin f_mzmax f_rtmed f_rtmin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> ko15.CDF           1          1    205     205     205    <span style="text-decoration: underline;">2</span>788.   <span style="text-decoration: underline;">2</span>785.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> ko15.CDF           1          2    206     206     206    <span style="text-decoration: underline;">2</span>785.   <span style="text-decoration: underline;">2</span>783.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> ko15.CDF           1          3    207.    207.    207.   <span style="text-decoration: underline;">2</span>713.   <span style="text-decoration: underline;">2</span>711.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> ko15.CDF           1          4    233     233     233    <span style="text-decoration: underline;">3</span>025.   <span style="text-decoration: underline;">3</span>024.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> ko15.CDF           1          5    233.    233.    233.   <span style="text-decoration: underline;">3</span>016.   <span style="text-decoration: underline;">3</span>015.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> ko15.CDF           1          6    240.    240.    240.   <span style="text-decoration: underline;">3</span>677.   <span style="text-decoration: underline;">3</span>675.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 19 more variables: f_rtmax &lt;dbl&gt;, ms_level &lt;int&gt;, isotopes &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   adduct &lt;chr&gt;, pcgroup &lt;int&gt;, filepath &lt;chr&gt;, filename &lt;chr&gt;, peakidx &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   mz &lt;dbl&gt;, mzmin &lt;dbl&gt;, mzmax &lt;dbl&gt;, rt &lt;dbl&gt;, rtmin &lt;dbl&gt;, rtmax &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   into &lt;dbl&gt;, intb &lt;dbl&gt;, maxo &lt;dbl&gt;, sn &lt;dbl&gt;, is_filled &lt;lgl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Explore the data</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: 'dplyr'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from 'package:MSnbase':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     combine</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from 'package:S4Vectors':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     first, intersect, rename, setdiff, setequal, union</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from 'package:Biobase':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     combine</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from 'package:BiocGenerics':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     combine, intersect, setdiff, setequal, union</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from 'package:generics':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     explain</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from 'package:xcms':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     collect, groups</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from 'package:stats':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from 'package:base':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Count features per sample</span></span></span>
<span class="r-in"><span><span class="va">peak_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">filename</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">into</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   filename n_features</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> ko15.CDF        292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> ko16.CDF        318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> ko18.CDF        303</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View adduct annotations</span></span></span>
<span class="r-in"><span><span class="va">peak_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">adduct</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">feature_id</span>, <span class="va">f_mzmed</span>, <span class="va">f_rtmed</span>, <span class="va">adduct</span>, <span class="va">pcgroup</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,044 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    feature_id f_mzmed f_rtmed adduct                                     pcgroup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>          1    205    <span style="text-decoration: underline;">2</span>788. <span style="color: #949494;">"</span>[M+H-C3H9N-C2H4O2]+ 323.091<span style="color: #949494;">"</span>                   10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>          2    206    <span style="text-decoration: underline;">2</span>785. <span style="color: #949494;">"</span>[M+H-NH3-C3H4]+ 262.041 [M+H-C4H6O]+ 275…      36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>          3    207.   <span style="text-decoration: underline;">2</span>713. <span style="color: #949494;">""</span>                                             164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>          4    233    <span style="text-decoration: underline;">3</span>025. <span style="color: #949494;">""</span>                                             181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>          5    233.   <span style="text-decoration: underline;">3</span>016. <span style="color: #949494;">""</span>                                             208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>          6    240.   <span style="text-decoration: underline;">3</span>677. <span style="color: #949494;">""</span>                                             228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>          7    241.   <span style="text-decoration: underline;">3</span>670. <span style="color: #949494;">""</span>                                              97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>          8    242.   <span style="text-decoration: underline;">3</span>674. <span style="color: #949494;">""</span>                                             202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>          9    244.   <span style="text-decoration: underline;">2</span>829. <span style="color: #949494;">""</span>                                             146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>         10    249.   <span style="text-decoration: underline;">3</span>664. <span style="color: #949494;">"</span>[M+H-C4H6-H2O]+ 320.158 [M+H-C4H6-NH3-H2…     111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1,034 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: With XcmsExperiment object</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/MsExperiment" class="external-link">MsExperiment</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">msdata</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: 'msdata'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from 'package:dplyr':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     ident</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load data as XcmsExperiment</span></span></span>
<span class="r-in"><span><span class="va">fls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"sciex"</span>, package <span class="op">=</span> <span class="st">"msdata"</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xdata_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/readMsExperiment.html" class="external-link">readMsExperiment</a></span><span class="op">(</span>spectraFiles <span class="op">=</span> <span class="va">fls</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Peak detection and grouping</span></span></span>
<span class="r-in"><span><span class="va">cwp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/findChromPeaks-centWave.html" class="external-link">CentWaveParam</a></span><span class="op">(</span>peakwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span><span class="op">)</span>, noise <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xdata_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/findChromPeaks.html" class="external-link">findChromPeaks</a></span><span class="op">(</span><span class="va">xdata_exp</span>, param <span class="op">=</span> <span class="va">cwp</span>, BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pdp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/groupChromPeaks.html" class="external-link">PeakDensityParam</a></span><span class="op">(</span>sampleGroups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, minFraction <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xdata_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/groupChromPeaks.html" class="external-link">groupChromPeaks</a></span><span class="op">(</span><span class="va">xdata_exp</span>, param <span class="op">=</span> <span class="va">pdp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create peak table without CAMERA</span></span></span>
<span class="r-in"><span><span class="va">peak_table_exp</span> <span class="op">&lt;-</span> <span class="fu">tidy_peaklist</span><span class="op">(</span><span class="va">xdata_exp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">peak_table_exp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 25</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sample_index spectraOrigin fromFile feature_id f_mzmed f_mzmin f_mzmax f_rtmed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>            1 /home/runner…        1          1    105.    105.    105.    63.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>            1 /home/runner…        1          2    105.    105.    105.   158. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>            1 /home/runner…        1          3    105.    105.    105.   203. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>            1 /home/runner…        1          4    106.    106.    106.   181. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>            1 /home/runner…        1          5    106.    106.    106.   195. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>            1 /home/runner…        1          6    106.    106.    106.    30.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 17 more variables: f_rtmin &lt;dbl&gt;, f_rtmax &lt;dbl&gt;, ms_level &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   filepath &lt;chr&gt;, filename &lt;chr&gt;, peakidx &lt;dbl&gt;, mz &lt;dbl&gt;, mzmin &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   mzmax &lt;dbl&gt;, rt &lt;dbl&gt;, rtmin &lt;dbl&gt;, rtmax &lt;dbl&gt;, into &lt;dbl&gt;, intb &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   maxo &lt;dbl&gt;, sn &lt;dbl&gt;, is_filled &lt;lgl&gt;</span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jan Stanstrup.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

