[{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"CLAUDE.md","title":"CLAUDE.md","text":"file provides guidance Claude Code (claude.ai/code) working code repository.","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"project-overview","dir":"","previous_headings":"","what":"Project Overview","title":"CLAUDE.md","text":"R package project named tidyXCMS, providing tidy interface XCMS metabolomics data processing.","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"project-task-management","dir":"","previous_headings":"","what":"Project Task Management","title":"CLAUDE.md","text":"IMPORTANT: project uses structured task management system minimize token usage: instructions.md: Contains current/active tasks. Keep file lightweight possible. completed_tasks.md: Archive completed tasks detailed documentation. future_tasks.md: Long-term development roadmap planned features. working tasks: 1. Check instructions.md current work 2. Move completed tasks completed_tasks.md details 3. Keep instructions.md minimal reduce token consumption 4. Reference files context rather duplicating information","code":""},{"path":[]},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"package-setup-and-building","dir":"","previous_headings":"R Package Development Commands","what":"Package Setup and Building","title":"CLAUDE.md","text":"","code":"# Install development dependencies install.packages(c(\"devtools\", \"roxygen2\", \"testthat\", \"usethis\"))  # Build package documentation from roxygen comments devtools::document()  # Install the package locally devtools::install()  # Build package bundle devtools::build()  # Check package (runs R CMD check) devtools::check()"},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"testing","dir":"","previous_headings":"R Package Development Commands","what":"Testing","title":"CLAUDE.md","text":"IMPORTANT: working specific functions, ALWAYS use testthat::test_file() run relevant test file. Running tests devtools::test() takes much longer necessary.","code":"# Run all tests (can be slow) devtools::test()  # Run a specific test file (PREFERRED - faster for development) testthat::test_file(\"tests/testthat/test-filename.R\")  # Run tests with coverage covr::package_coverage()"},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"development-workflow","dir":"","previous_headings":"R Package Development Commands","what":"Development Workflow","title":"CLAUDE.md","text":"","code":"# Load package for interactive development devtools::load_all()  # Create new function/data documentation usethis::use_r(\"function_name\")  # Add test file usethis::use_test(\"function_name\")  # Add package dependency usethis::use_package(\"package_name\")"},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"r-package-structure","dir":"","previous_headings":"","what":"R Package Structure","title":"CLAUDE.md","text":"creating R package files, follow structure: DESCRIPTION - Package metadata dependencies NAMESPACE - Package namespace (auto-generated roxygen2) R/ - R source code files man/ - Documentation files (auto-generated roxygen2) tests/testthat/ - Unit tests vignettes/ - Long-form documentation data/ - Package datasets inst/ - Additional files installed dev-docs/ - Research documentation implementation guides (part package, ignored R CMD build)","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"code-style","dir":"","previous_headings":"","what":"Code Style","title":"CLAUDE.md","text":"project follows standard R package conventions: - Use 2 spaces indentation (configured .Rproj file) - Strip trailing whitespace (configured .Rproj file) - Auto-append newline files (configured .Rproj file) - Use UTF-8 encoding","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"testing-requirements","dir":"","previous_headings":"","what":"Testing Requirements","title":"CLAUDE.md","text":"IMPORTANT: functions MUST comprehensive tests: - Test compatibility XCMSnExp XcmsExperiment objects - Even examples/vignettes focus XcmsExperiment, tests must verify XCMSnExp works - Write tests tests/testthat/test-*.R files - Use testthat::test_file() run individual test files - Ensure major code paths covered","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"bioconductor-parallel-processing","dir":"","previous_headings":"","what":"Bioconductor Parallel Processing","title":"CLAUDE.md","text":"IMPORTANT: Always use SerialParam() example code tests: SerialParam? - Faster small datasets: Avoids parallel processing overhead - Eliminates warnings: Prevents ‚Äú‚Äòpackage:stats‚Äô may available‚Äù warnings - Cleaner output: parallel-related messages - Better reproducibility: Consistent behavior across systems use SerialParam: - test files (tests/testthat/) - vignettes examples - code small sample sizes (< 20 samples typically) functions support BPPARAM: - ‚úÖ readMsExperiment() - supports BPPARAM - ‚úÖ findChromPeaks() - supports BPPARAM - ‚ùå groupChromPeaks() - support BPPARAM - ‚ùå adjustRtime() - support BPPARAM Note: Users can still use parallel processing production omitting BPPARAM setting parallel backend.","code":"library(BiocParallel)  # Always include BPPARAM = SerialParam() for functions that support it: xdata <- readMsExperiment(spectraFiles = files, BPPARAM = SerialParam()) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Note: groupChromPeaks does NOT have BPPARAM parameter xdata <- groupChromPeaks(xdata, param = pdp)"},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"key-resources","dir":"","previous_headings":"","what":"Key Resources","title":"CLAUDE.md","text":"XCMS Repository: https://github.com/sneumann/xcms XCMS Source Code: https://github.com/sneumann/xcms/tree/devel/R Metabonaut Tutorials: https://github.com/rformassspectrometry/Metabonaut Original Discussion: https://github.com/sneumann/xcms/issues/551","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"important-conventions","dir":"","previous_headings":"","what":"Important Conventions","title":"CLAUDE.md","text":"Follow XCMS conventions object types methods Maintain compatibility XCMSnExp xcmsExperiment objects Write comprehensive roxygen2 documentation Add examples (even marked \\dontrun) tasks completed, move completed_tasks.md","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"git-workflow","dir":"","previous_headings":"","what":"Git Workflow","title":"CLAUDE.md","text":"Default branch: main feat: - New feature (triggers minor version bump) fix: - Bug fix (triggers patch version bump) docs: - Documentation changes style: - Code style changes (formatting, etc.) refactor: - Code refactoring test: - Adding updating tests chore: - Maintenance tasks Example: feat: add tidy interface peak detection Run R CMD check push/PR Deploy pkgdown site push main Create releases via semantic-release based commit messages Always commit co-authorship footer using Claude Code","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"pre-commit-checklist","dir":"","previous_headings":"","what":"Pre-Commit Checklist","title":"CLAUDE.md","text":"IMPORTANT: committing changes, ALWAYS run checks order:","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"id_0-update-description-if-needed","dir":"","previous_headings":"Pre-Commit Checklist","what":"0. Update DESCRIPTION (if needed)","title":"CLAUDE.md","text":"modifying functions, check DESCRIPTION needs updates: - Add new package dependencies Imports: using new packages - Update Suggests: optional dependencies (testing, vignettes) - Ensure imported packages listed","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"id_1-regenerate-documentation","dir":"","previous_headings":"Pre-Commit Checklist","what":"1. Regenerate Documentation","title":"CLAUDE.md","text":"ensures function documentation imports date.","code":"# Update NAMESPACE and .Rd files from roxygen2 comments roxygen2::roxygenize()"},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"id_2-r-cmd-check","dir":"","previous_headings":"Pre-Commit Checklist","what":"2. R CMD Check","title":"CLAUDE.md","text":"Fix errors warnings committing. Address notes relevant.","code":"# Check package for errors, warnings, and notes devtools::check()"},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"id_3-build-pkgdown-site","dir":"","previous_headings":"Pre-Commit Checklist","what":"3. Build pkgdown Site","title":"CLAUDE.md","text":"Check : - errors site build - vignettes render correctly - function documentation displays properly - broken links missing references commit three checks pass successfully.","code":"# Load all package code devtools::load_all()  # Build pkgdown site locally pkgdown::build_site()"},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"id_4-reinstall-package","dir":"","previous_headings":"Pre-Commit Checklist","what":"4. Reinstall Package","title":"CLAUDE.md","text":"ensures package fully functional changes.","code":"# Reinstall the package to ensure all changes are properly loaded devtools::install()"},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"id_5-commit-changes","dir":"","previous_headings":"Pre-Commit Checklist","what":"5. Commit Changes","title":"CLAUDE.md","text":"checks pass, commit changes using semantic-release format: - Use conventional commit messages (feat:, fix:, docs:, etc.) - Always include co-authorship footer using Claude Code - Example:","code":"git add -A git commit -m \"feat: add new tidy interface function  ü§ñ Generated with [Claude Code](https://claude.com/claude-code)  Co-Authored-By: Claude <noreply@anthropic.com>\""},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"pre-push-checklist","dir":"","previous_headings":"","what":"Pre-Push Checklist","title":"CLAUDE.md","text":"committing, verify everything working pushing GitHub: - Ensure devtools::check() passes errors/warnings - Ensure pkgdown::build_site() completes without errors - Review git status ensure unintended files included","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/CLAUDE.html","id":"task-management","dir":"","previous_headings":"","what":"Task Management","title":"CLAUDE.md","text":"IMPORTANT: start working new tasks instructions.md unless explicitly told user. Wait user give go-ahead proceeding tasks. CRITICAL: Make commits frequently completing task logical unit work: - Commit completed task instructions.md - Don‚Äôt batch multiple tasks one commit - Use semantic commit format commit (feat:, fix:, docs:, etc.) - provides better granularity makes easier track changes - Example workflow: 1. Complete task 1 ‚Üí commit 2. Complete task 2 ‚Üí commit 3. Complete task 3 ‚Üí commit etc.","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 tidyXCMS authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"tidyXCMS package provides functions work XCMS metabolomics data tidy, long-format structure. vignette demonstrates use XCMSnExp_CAMERA_peaklist_long() function create comprehensive peak table integrates: Peak detection results XCMS Feature grouping (correspondence) information CAMERA annotations (isotopes, adducts, pseudospectrum groups) - optional Sample metadata resulting long-format table one row per feature per sample, making ideal downstream analysis tidyverse tools like dplyr ggplot2. Note: CAMERA annotations optional. can create peak table without CAMERA annotations simply omitting xsAnnotate parameter. useful quick data exploration CAMERA annotations required analysis.","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"","code":"library(tidyXCMS) library(xcms) library(CAMERA) library(BiocParallel) library(dplyr) library(ggplot2)"},{"path":[]},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"load-example-data","dir":"Articles","previous_headings":"Example Workflow","what":"Load Example Data","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"‚Äôll use faahko_sub dataset XCMS, contains LC-MS data wild-type knockout samples.","code":"# Load example data from XCMS faahko_sub <- loadXcmsData(\"faahko_sub\")  # Check the files fileNames(faahko_sub) #> [1] \"/home/runner/work/_temp/Library/faahKO/cdf/KO/ko15.CDF\" #> [2] \"/home/runner/work/_temp/Library/faahKO/cdf/KO/ko16.CDF\" #> [3] \"/home/runner/work/_temp/Library/faahKO/cdf/KO/ko18.CDF\""},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"add-sample-metadata","dir":"Articles","previous_headings":"Example Workflow","what":"Add Sample Metadata","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"Let‚Äôs add sample information included final table.","code":"library(Biobase)  pd <- data.frame(   sample_name = basename(fileNames(faahko_sub)),   sample_group = c(\"WT\", \"KO\", \"WT\")[1:length(fileNames(faahko_sub))],   injection_order = 1:length(fileNames(faahko_sub)),   row.names = basename(fileNames(faahko_sub)) )  pData(faahko_sub) <- pd"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"peak-detection","dir":"Articles","previous_headings":"Example Workflow","what":"Peak Detection","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"Perform chromatographic peak detection using CentWave algorithm.","code":"# Define peak detection parameters cwp <- CentWaveParam(   peakwidth = c(20, 80),   noise = 5000,   ppm = 25 )  # Find peaks (using SerialParam for reproducibility) xdata <- findChromPeaks(faahko_sub, param = cwp, BPPARAM = SerialParam())  # Check results cat(\"Detected\", nrow(chromPeaks(xdata)), \"peaks across\",     length(fileNames(xdata)), \"samples\\n\") #> Detected 1750 peaks across 3 samples"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"feature-grouping-correspondence","dir":"Articles","previous_headings":"Example Workflow","what":"Feature Grouping (Correspondence)","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"Group peaks across samples features (aligned peaks).","code":"# Define grouping parameters pdp <- PeakDensityParam(   sampleGroups = pData(xdata)$sample_group,   minFraction = 0.5,   bw = 30 )  # Group peaks xdata <- groupChromPeaks(xdata, param = pdp)  # Check results cat(\"Grouped peaks into\", nrow(featureDefinitions(xdata)), \"features\\n\") #> Grouped peaks into 842 features"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"create-long-format-peak-table-without-camera","dir":"Articles","previous_headings":"Example Workflow","what":"Create Long-Format Peak Table (Without CAMERA)","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"can create long-format peak table directly XCMS results without using CAMERA annotations. useful want quickly explore data CAMERA annotations needed analysis. resulting table contains feature peak information. CAMERA annotation columns (isotopes, adduct, pcgroup) included CAMERA annotations provided, keeping output cleaner memory-efficient.","code":"# Create peak table without CAMERA peak_table_no_camera <- XCMSnExp_CAMERA_peaklist_long(xdata)  # Check the structure dim(peak_table_no_camera) #> [1] 2526   26  # View first few rows head(peak_table_no_camera) #> # A tibble: 6 √ó 26 #>   sample_name sample_group injection_order fromFile feature_id f_mzmed f_mzmin #>   <chr>       <chr>                  <int>    <dbl>      <int>   <dbl>   <dbl> #> 1 ko15.CDF    WT                         1        1          1    200.    200. #> 2 ko15.CDF    WT                         1        1          2    201.    201. #> 3 ko15.CDF    WT                         1        1          3    205     205  #> 4 ko15.CDF    WT                         1        1          4    206.    206. #> 5 ko15.CDF    WT                         1        1          5    206     206  #> 6 ko15.CDF    WT                         1        1          6    207.    207. #> # ‚Ñπ 19 more variables: f_mzmax <dbl>, f_rtmed <dbl>, f_rtmin <dbl>, #> #   f_rtmax <dbl>, ms_level <int>, filepath <chr>, filename <chr>, #> #   peakidx <dbl>, mz <dbl>, mzmin <dbl>, mzmax <dbl>, rt <dbl>, rtmin <dbl>, #> #   rtmax <dbl>, into <dbl>, intb <dbl>, maxo <dbl>, sn <dbl>, is_filled <lgl>  # Check column names - note that isotopes, adduct, and pcgroup are NOT present colnames(peak_table_no_camera) #>  [1] \"sample_name\"     \"sample_group\"    \"injection_order\" \"fromFile\"        #>  [5] \"feature_id\"      \"f_mzmed\"         \"f_mzmin\"         \"f_mzmax\"         #>  [9] \"f_rtmed\"         \"f_rtmin\"         \"f_rtmax\"         \"ms_level\"        #> [13] \"filepath\"        \"filename\"        \"peakidx\"         \"mz\"              #> [17] \"mzmin\"           \"mzmax\"           \"rt\"              \"rtmin\"           #> [21] \"rtmax\"           \"into\"            \"intb\"            \"maxo\"            #> [25] \"sn\"              \"is_filled\""},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"camera-annotation-optional","dir":"Articles","previous_headings":"Example Workflow","what":"CAMERA Annotation (Optional)","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"Use CAMERA annotate isotopes, adducts, group features pseudospectra. Note: CAMERA requires xcmsSet object, first convert XCMSnExp object using (\"xcmsSet\").","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"creating-a-camera-object","dir":"Articles","previous_headings":"Example Workflow > CAMERA Annotation (Optional)","what":"Creating a CAMERA object","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"first step create CAMERA object XCMS object. specify polarity help CAMERA determine appropriate adducts fragments.","code":"# Convert to xcmsSet for CAMERA (required for compatibility) xset <- as(xdata, \"xcmsSet\")  # Create xsAnnotate object with polarity xs <- xsAnnotate(xset, polarity = \"positive\")"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"grouping-coeluting-peaks","dir":"Articles","previous_headings":"Example Workflow > CAMERA Annotation (Optional)","what":"Grouping coeluting peaks","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"first step grouping features group co-eluting peaks. na√Øve approach refine later.","code":"# Group peaks by retention time xs <- groupFWHM(xs, perfwhm = 0.1, intval = \"into\", sigma = 6) #> Start grouping after retention time. #> Created 465 pseudospectra."},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"grouping-based-on-correlation","dir":"Articles","previous_headings":"Example Workflow > CAMERA Annotation (Optional)","what":"Grouping based on correlation","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"Now group features based correlations. looks group previous step splits separate groups peaks correlate . Note: small example dataset, use simplified approach. real workflows samples, use stricter parameters enable correlation across samples (calcCaS = TRUE).","code":"# Group by correlation # For small datasets, we skip correlation analysis to avoid errors # In production with adequate samples, use: # xs <- groupCorr(xs, calcCaS = TRUE, cor_eic_th = 0.7, pval = 0.05)  # For this example, we skip the correlation step and proceed directly # xs <- groupCorr(xs, calcIso = FALSE, calcCiS = FALSE, calcCaS = FALSE)"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"isotope-annotation","dir":"Articles","previous_headings":"Example Workflow > CAMERA Annotation (Optional)","what":"Isotope annotation","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"annotates peaks possible isotopes based m/z difference intensity patterns.","code":"# Find isotopes xs <- findIsotopes(xs, ppm = 10, mzabs = 0.01, intval = \"into\", maxcharge = 2) #> Generating peak matrix! #> Run isotope peak annotation #>  % finished: 10  20  30  40  50  60  70  80  90  100   #> Found isotopes: 39"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"annotation-of-adducts-and-fragments","dir":"Articles","previous_headings":"Example Workflow > CAMERA Annotation (Optional)","what":"Annotation of adducts and fragments","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"Now try annotate adducts fragments based expected mass differences.","code":"# Find adducts xs <- findAdducts(xs, ppm = 10, mzabs = 0.01, multiplier = 4, polarity = \"positive\") #> Generating peak matrix for peak annotation! #> Polarity is set in xsAnnotate: positive  #> Ruleset could not read from object! Recalculate #>  #> Calculating possible adducts in 465 Groups...  #>  % finished: 10  20  30  40  50  60  70  80  90  100"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"create-long-format-peak-table","dir":"Articles","previous_headings":"Example Workflow","what":"Create Long-Format Peak Table","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"Now can create comprehensive long-format peak table! Note use original xdata (XCMSnExp) object along CAMERA annotations xs.","code":"peak_table <- XCMSnExp_CAMERA_peaklist_long(xdata, xs)  # Check the structure dim(peak_table) #> [1] 2526   29 colnames(peak_table) #>  [1] \"sample_name\"     \"sample_group\"    \"injection_order\" \"fromFile\"        #>  [5] \"feature_id\"      \"f_mzmed\"         \"f_mzmin\"         \"f_mzmax\"         #>  [9] \"f_rtmed\"         \"f_rtmin\"         \"f_rtmax\"         \"isotopes\"        #> [13] \"adduct\"          \"pcgroup\"         \"ms_level\"        \"filepath\"        #> [17] \"filename\"        \"peakidx\"         \"mz\"              \"mzmin\"           #> [21] \"mzmax\"           \"rt\"              \"rtmin\"           \"rtmax\"           #> [25] \"into\"            \"intb\"            \"maxo\"            \"sn\"              #> [29] \"is_filled\""},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"understanding-the-output","dir":"Articles","previous_headings":"","what":"Understanding the Output","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"resulting tibble contains comprehensive information feature sample. complete description columns:","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"column-reference-table","dir":"Articles","previous_headings":"Understanding the Output","what":"Column Reference Table","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"table organized logical groups easier understanding: Important notes: row represents one feature one sample feature detected sample, peak-level columns (mz, rt, , etc.) NA Feature-level statistics (f_mzmed, f_rtmed, etc.) always present represent values across samples CAMERA annotations apply feature level across samples given feature Feature-level (prefix f_): Statistics aggregated across samples Peak-level (prefix): Values specific peak specific sample","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"feature-level-information","dir":"Articles","previous_headings":"Understanding the Output","what":"Feature-Level Information","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"columns describe feature (grouped peak):","code":"peak_table %>%   select(feature_id, f_mzmed, f_rtmed) %>%   distinct() %>%   head() #> # A tibble: 6 √ó 3 #>   feature_id f_mzmed f_rtmed #>        <int>   <dbl>   <dbl> #> 1          1    200.   2877. #> 2          2    201.   3141. #> 3          3    205    2788. #> 4          4    206.   2796. #> 5          5    206    2785. #> 6          6    207.   2713."},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"camera-annotations","dir":"Articles","previous_headings":"Understanding the Output","what":"CAMERA Annotations","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"isotopes: Isotope annotation (e.g., ‚Äú[M]+‚Äù, ‚Äú[M+1]+‚Äù) adduct: Adduct annotation (e.g., ‚Äú[M+H]+‚Äù, ‚Äú[M+Na]+‚Äù) pcgroup: Pseudospectrum correlation group ID","code":"# View features with adduct annotations peak_table %>%   filter(!is.na(adduct)) %>%   select(feature_id, f_mzmed, f_rtmed, isotopes, adduct, pcgroup) %>%   distinct(feature_id, .keep_all = TRUE) %>%   head() #> # A tibble: 6 √ó 6 #>   feature_id f_mzmed f_rtmed isotopes adduct pcgroup #>        <int>   <dbl>   <dbl> <chr>    <chr>    <int> #> 1          1    200.   2877. \"\"       \"\"         228 #> 2          2    201.   3141. \"\"       \"\"         227 #> 3          3    205    2788. \"\"       \"\"          10 #> 4          4    206.   2796. \"\"       \"\"         457 #> 5          5    206    2785. \"\"       \"\"          41 #> 6          6    207.   2713. \"\"       \"\"         245"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"peak-level-information","dir":"Articles","previous_headings":"Understanding the Output","what":"Peak-Level Information","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"feature sample: mz, rt: Detected peak position : Integrated peak intensity intb: Baseline-corrected intensity maxo: Maximum intensity sn: Signal--noise ratio","code":"# View detected peaks (non-NA intensities) peak_table %>%   filter(!is.na(into)) %>%   select(feature_id, filename, mz, rt, into, sn) %>%   head() #> # A tibble: 6 √ó 6 #>   feature_id filename    mz    rt     into    sn #>        <int> <chr>    <dbl> <dbl>    <dbl> <dbl> #> 1          3 ko15.CDF  205  2785. 1924712.    64 #> 2          4 ko15.CDF  206. 2796.   57359.  8177 #> 3          5 ko15.CDF  206  2783.  213659.    14 #> 4          6 ko15.CDF  207. 2711.  349011.    17 #> 5          7 ko15.CDF  221. 3079.  163255.  7841 #> 6          9 ko15.CDF  231  3079.  328034. 10059"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"sample-information","dir":"Articles","previous_headings":"Understanding the Output","what":"Sample Information","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"filename, filepath: Sample file information fromFile: Sample index Plus columns pData() (sample metadata)","code":"peak_table %>%   select(feature_id, filename, sample_group, injection_order) %>%   head() #> # A tibble: 6 √ó 4 #>   feature_id filename sample_group injection_order #>        <int> <chr>    <chr>                  <int> #> 1          1 ko15.CDF WT                         1 #> 2          2 ko15.CDF WT                         1 #> 3          3 ko15.CDF WT                         1 #> 4          4 ko15.CDF WT                         1 #> 5          5 ko15.CDF WT                         1 #> 6          6 ko15.CDF WT                         1"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"missing-values","dir":"Articles","previous_headings":"Understanding the Output","what":"Missing Values","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"Features detected sample NA peak-level columns:","code":"# Count detected features per sample peak_table %>%   group_by(filename) %>%   summarise(     n_features_detected = sum(!is.na(into)),     n_features_total = n()   ) #> # A tibble: 3 √ó 3 #>   filename n_features_detected n_features_total #>   <chr>                  <int>            <int> #> 1 ko15.CDF                 436              842 #> 2 ko16.CDF                 606              842 #> 3 ko18.CDF                 365              842"},{"path":[]},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"visualize-feature-intensities","dir":"Articles","previous_headings":"Downstream Analysis Examples","what":"Visualize Feature Intensities","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"","code":"# Plot intensity distribution by sample group peak_table %>%   filter(!is.na(into)) %>%   ggplot(aes(x = sample_group, y = log10(into), fill = sample_group)) +   geom_boxplot() +   labs(     title = \"Feature Intensity Distribution\",     x = \"Sample Group\",     y = \"log10(Intensity)\"   ) +   theme_minimal()"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"identify-features-with-adduct-annotations","dir":"Articles","previous_headings":"Downstream Analysis Examples","what":"Identify Features with Adduct Annotations","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"","code":"# Count features by adduct type peak_table %>%   filter(!is.na(adduct)) %>%   distinct(feature_id, adduct) %>%   count(adduct, sort = TRUE) #> # A tibble: 75 √ó 2 #>    adduct                       n #>    <chr>                    <int> #>  1 \"\"                         768 #>  2 \"[2M+Na+2K]3+ 590.193\"       1 #>  3 \"[2M+Na+3K-H]3+ 589.198\"     1 #>  4 \"[3M+2Na]2+ 210.138\"         1 #>  5 \"[3M+H+Na]2+ 384.195\"        1 #>  6 \"[M+2H-CH4]2+ 524.213\"       1 #>  7 \"[M+2Na-H]+ 384.234\"         1 #>  8 \"[M+H+NH3]+ 304.113\"         1 #>  9 \"[M+H-C2H4]+ 328.015\"        1 #> 10 \"[M+H-C2H4]+ 519.288\"        1 #> # ‚Ñπ 65 more rows"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"find-features-present-in-all-samples","dir":"Articles","previous_headings":"Downstream Analysis Examples","what":"Find Features Present in All Samples","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"","code":"# Features detected in all samples complete_features <- peak_table %>%   group_by(feature_id) %>%   summarise(     n_detected = sum(!is.na(into)),     n_samples = n(),     .groups = \"drop\"   ) %>%   filter(n_detected == n_samples)  cat(\"Found\", nrow(complete_features), \"features detected in all samples\\n\") #> Found 217 features detected in all samples"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"coefficient-of-variation-analysis","dir":"Articles","previous_headings":"Downstream Analysis Examples","what":"Coefficient of Variation Analysis","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"","code":"# Calculate CV for each feature feature_cv <- peak_table %>%   filter(!is.na(into)) %>%   group_by(feature_id, f_mzmed, f_rtmed) %>%   summarise(     mean_intensity = mean(into),     sd_intensity = sd(into),     cv = sd_intensity / mean_intensity * 100,     .groups = \"drop\"   ) %>%   arrange(cv)  # Show most stable features head(feature_cv) #> # A tibble: 6 √ó 6 #>   feature_id f_mzmed f_rtmed mean_intensity sd_intensity    cv #>        <int>   <dbl>   <dbl>          <dbl>        <dbl> <dbl> #> 1        498    486.   2798.        227942.         246. 0.108 #> 2        454    466.   3193.        173672.         607. 0.350 #> 3        245    369.   3770.        996200.        6299. 0.632 #> 4        286    386.   3446.        205233.        1332. 0.649 #> 5        235    366.   2767.       1096511.       14736. 1.34  #> 6        108    311.   3070.        277669.        4432. 1.60"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"extract-specific-features-for-further-analysis","dir":"Articles","previous_headings":"Downstream Analysis Examples","what":"Extract Specific Features for Further Analysis","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"","code":"# Get a specific feature across all samples feature_123 <- peak_table %>%   filter(feature_id == 123) %>%   select(feature_id, filename, sample_group, mz, rt, into)  head(feature_123) #> # A tibble: 3 √ó 6 #>   feature_id filename sample_group    mz    rt    into #>        <int> <chr>    <chr>        <dbl> <dbl>   <dbl> #> 1        123 ko15.CDF WT             NA    NA      NA  #> 2        123 ko16.CDF KO            316. 3450. 167161. #> 3        123 ko18.CDF WT             NA    NA      NA"},{"path":"https://stanstrup.github.io/tidyXCMS/articles/long-format-peaklist.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Creating Long-Format Peak Tables with Optional CAMERA Annotations","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] MSnbase_2.36.0      ProtGenerics_1.42.0 S4Vectors_0.48.0    #>  [4] mzR_2.44.0          Rcpp_1.1.0          ggplot2_4.0.0       #>  [7] dplyr_1.1.4         CAMERA_1.66.0       Biobase_2.70.0      #> [10] BiocGenerics_0.56.0 generics_0.1.4      xcms_4.8.0          #> [13] BiocParallel_1.44.0 tidyXCMS_0.0.0      #>  #> loaded via a namespace (and not attached): #>   [1] DBI_1.2.3                   RBGL_1.86.0                 #>   [3] gridExtra_2.3               rlang_1.1.6                 #>   [5] magrittr_2.0.4              clue_0.3-66                 #>   [7] MassSpecWavelet_1.76.0      matrixStats_1.5.0           #>   [9] compiler_4.5.2              systemfonts_1.3.1           #>  [11] vctrs_0.6.5                 reshape2_1.4.4              #>  [13] stringr_1.6.0               pkgconfig_2.0.3             #>  [15] MetaboCoreUtils_1.18.0      crayon_1.5.3                #>  [17] fastmap_1.2.0               backports_1.5.0             #>  [19] XVector_0.50.0              labeling_0.4.3              #>  [21] utf8_1.2.6                  rmarkdown_2.30              #>  [23] graph_1.88.0                preprocessCore_1.72.0       #>  [25] ragg_1.5.0                  purrr_1.2.0                 #>  [27] xfun_0.54                   MultiAssayExperiment_1.36.0 #>  [29] cachem_1.1.0                jsonlite_2.0.0              #>  [31] progress_1.2.3              DelayedArray_0.36.0         #>  [33] prettyunits_1.2.0           parallel_4.5.2              #>  [35] cluster_2.1.8.1             R6_2.6.1                    #>  [37] bslib_0.9.0                 stringi_1.8.7               #>  [39] RColorBrewer_1.1-3          limma_3.66.0                #>  [41] rpart_4.1.24                GenomicRanges_1.62.0        #>  [43] jquerylib_0.1.4             Seqinfo_1.0.0               #>  [45] SummarizedExperiment_1.40.0 iterators_1.0.14            #>  [47] knitr_1.50                  base64enc_0.1-3             #>  [49] IRanges_2.44.0              BiocBaseUtils_1.12.0        #>  [51] nnet_7.3-20                 Matrix_1.7-4                #>  [53] igraph_2.2.1                tidyselect_1.2.1            #>  [55] rstudioapi_0.17.1           abind_1.4-8                 #>  [57] yaml_2.3.10                 doParallel_1.0.17           #>  [59] codetools_0.2-20            affy_1.88.0                 #>  [61] lattice_0.22-7              tibble_3.3.0                #>  [63] plyr_1.8.9                  withr_3.0.2                 #>  [65] S7_0.2.0                    evaluate_1.0.5              #>  [67] foreign_0.8-90              desc_1.4.3                  #>  [69] Spectra_1.20.0              pillar_1.11.1               #>  [71] affyio_1.80.0               BiocManager_1.30.26         #>  [73] MatrixGenerics_1.22.0       checkmate_2.3.3             #>  [75] foreach_1.5.2               MALDIquant_1.22.3           #>  [77] ncdf4_1.24                  hms_1.1.4                   #>  [79] scales_1.4.0                MsExperiment_1.12.0         #>  [81] glue_1.8.0                  Hmisc_5.2-4                 #>  [83] MsFeatures_1.18.0           lazyeval_0.2.2              #>  [85] tools_4.5.2                 mzID_1.48.0                 #>  [87] data.table_1.17.8           QFeatures_1.20.0            #>  [89] vsn_3.78.0                  fs_1.6.6                    #>  [91] XML_3.99-0.20               grid_4.5.2                  #>  [93] impute_1.84.0               tidyr_1.3.1                 #>  [95] colorspace_2.1-2            MsCoreUtils_1.21.0          #>  [97] PSMatch_1.14.0              htmlTable_2.4.3             #>  [99] Formula_1.2-5               cli_3.6.5                   #> [101] textshaping_1.0.4           S4Arrays_1.10.0             #> [103] AnnotationFilter_1.34.0     pcaMethods_2.2.0            #> [105] gtable_0.3.6                sass_0.4.10                 #> [107] digest_0.6.37               SparseArray_1.10.1          #> [109] htmlwidgets_1.6.4           farver_2.1.2                #> [111] htmltools_0.5.8.1           pkgdown_2.2.0               #> [113] lifecycle_1.0.4             statmod_1.5.1               #> [115] MASS_7.3-65"},{"path":"https://stanstrup.github.io/tidyXCMS/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jan Stanstrup. Author, maintainer.","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Stanstrup J (2025). tidyXCMS: Tidy Interface XCMS Metabolomics Data Processing. R package version 0.0.0, https://stanstrup.github.io/tidyXCMS.","code":"@Manual{,   title = {tidyXCMS: Tidy Interface for XCMS Metabolomics Data Processing},   author = {Jan Stanstrup},   year = {2025},   note = {R package version 0.0.0},   url = {https://stanstrup.github.io/tidyXCMS}, }"},{"path":"https://stanstrup.github.io/tidyXCMS/index.html","id":"tidyxcms","dir":"","previous_headings":"","what":"Tidy Interface for XCMS Metabolomics Data Processing","title":"Tidy Interface for XCMS Metabolomics Data Processing","text":"Tidy interface XCMS metabolomics data processing","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Tidy Interface for XCMS Metabolomics Data Processing","text":"tidyXCMS provides modern, tidy interface working XCMS metabolomics data, making easier integrate XCMS workflows tidyverse ecosystem.","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Tidy Interface for XCMS Metabolomics Data Processing","text":"","code":"# Install from GitHub # devtools::install_github(\"stanstrup/tidyXCMS\")"},{"path":"https://stanstrup.github.io/tidyXCMS/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Tidy Interface for XCMS Metabolomics Data Processing","text":"Coming soon‚Ä¶","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/index.html","id":"development","dir":"","previous_headings":"","what":"Development","title":"Tidy Interface for XCMS Metabolomics Data Processing","text":"package uses: - Semantic versioning via semantic-release - Automated documentation via pkgdown - Continuous integration via GitHub Actions","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Tidy Interface for XCMS Metabolomics Data Processing","text":"MIT License","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/reference/XCMSnExp_CAMERA_peaklist_long.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Long-Format Peak Table with Optional CAMERA Annotations ‚Äî XCMSnExp_CAMERA_peaklist_long","title":"Create Long-Format Peak Table with Optional CAMERA Annotations ‚Äî XCMSnExp_CAMERA_peaklist_long","text":"Generates comprehensive long-format peak table row represents one feature one sample. Optionally includes CAMERA annotations isotopes, adducts, pseudospectrum groups provided.","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/reference/XCMSnExp_CAMERA_peaklist_long.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Long-Format Peak Table with Optional CAMERA Annotations ‚Äî XCMSnExp_CAMERA_peaklist_long","text":"","code":"XCMSnExp_CAMERA_peaklist_long(XCMSnExp, xsAnnotate = NULL)"},{"path":"https://stanstrup.github.io/tidyXCMS/reference/XCMSnExp_CAMERA_peaklist_long.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Long-Format Peak Table with Optional CAMERA Annotations ‚Äî XCMSnExp_CAMERA_peaklist_long","text":"XCMSnExp xcms::XCMSnExp xcms::XcmsExperiment object containing peak detection feature grouping results. xsAnnotate Optional. xsAnnotate object CAMERA package containing peak annotations (isotopes, adducts, pseudospectrum groups). NULL (default), annotation columns included output.","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/reference/XCMSnExp_CAMERA_peaklist_long.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Long-Format Peak Table with Optional CAMERA Annotations ‚Äî XCMSnExp_CAMERA_peaklist_long","text":"tibble::tibble long format one row per feature per sample. tibble contains: Feature-level columns f_mzmed, f_mzmin, f_mzmax, f_rtmed, f_rtmin, f_rtmax - feature summary statistics CAMERA annotations isotopes, adduct, pcgroup (pseudospectrum group) - present xsAnnotate provided Peak-level columns mz, rt, , intb, maxo, sn - individual peak measurements Sample information filepath, filename, fromFile - sample identifiers Additional columns columns pData(XCMSnExp) sampleData(XcmsExperiment)","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/reference/XCMSnExp_CAMERA_peaklist_long.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create Long-Format Peak Table with Optional CAMERA Annotations ‚Äî XCMSnExp_CAMERA_peaklist_long","text":"function integrates data multiple sources: Chromatographic peaks xcms::chromPeaks() Feature definitions xcms::featureDefinitions() Feature intensities xcms::featureValues() CAMERA annotations xsAnnotate object (provided) Sample metadata Biobase::pData() function supports xcms::XCMSnExp xcms::XcmsExperiment objects, providing flexibility modern XCMS workflows. function performs several data processing steps: Extracts peaks adds file path information Combines feature definitions CAMERA annotations Unnests peak indices create feature-peak relationships Joins feature intensities match peaks features Filters ensure peak intensities match feature intensities Handles duplicate peaks taking first occurrence Completes data frame include feature-sample combinations Adds sample metadata pData Missing values (NA) indicate feature detected particular sample.","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/reference/XCMSnExp_CAMERA_peaklist_long.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Create Long-Format Peak Table with Optional CAMERA Annotations ‚Äî XCMSnExp_CAMERA_peaklist_long","text":"XCMS sometimes creates duplicate peaks; function keeps first occurrence. function uses \"maxint\" method feature values, meaning takes maximum intensity peak feature sample. CAMERA annotations optional. xsAnnotate NULL, isotopes, adduct, pcgroup columns present output. XcmsExperiment objects, sample metadata accessed via sampleData() instead pData().","code":""},{"path":"https://stanstrup.github.io/tidyXCMS/reference/XCMSnExp_CAMERA_peaklist_long.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Long-Format Peak Table with Optional CAMERA Annotations ‚Äî XCMSnExp_CAMERA_peaklist_long","text":"","code":"if (FALSE) { # \\dontrun{ library(xcms) library(BiocParallel)  # Load example data faahko_sub <- loadXcmsData(\"faahko_sub\")  # Peak detection cwp <- CentWaveParam(peakwidth = c(20, 80), noise = 5000) xdata <- findChromPeaks(faahko_sub, param = cwp, BPPARAM = SerialParam())  # Peak grouping pdp <- PeakDensityParam(sampleGroups = rep(1, length(fileNames(xdata))),                         minFraction = 0.5) xdata <- groupChromPeaks(xdata, param = pdp)  # Example 1: Without CAMERA annotations peak_table_no_camera <- XCMSnExp_CAMERA_peaklist_long(xdata) head(peak_table_no_camera)  # Example 2: With CAMERA annotations library(CAMERA)  # Convert to xcmsSet for CAMERA (CAMERA requires the old xcmsSet class) xset <- as(xdata, \"xcmsSet\")  # CAMERA annotation xs <- xsAnnotate(xset) xs <- groupFWHM(xs) xs <- findIsotopes(xs) xs <- groupCorr(xs) xs <- findAdducts(xs)  # Create long-format peak table (pass XCMSnExp object, not xcmsSet) peak_table <- XCMSnExp_CAMERA_peaklist_long(xdata, xs) head(peak_table)  # Explore the data library(dplyr)  # Count features per sample peak_table %>%   group_by(filename) %>%   summarize(n_features = sum(!is.na(into)))  # View adduct annotations peak_table %>%   filter(!is.na(adduct)) %>%   select(feature_id, f_mzmed, f_rtmed, adduct, pcgroup)  # Example 3: With XcmsExperiment object library(MsExperiment) library(msdata)  # Load data as XcmsExperiment fls <- dir(system.file(\"sciex\", package = \"msdata\"), full.names = TRUE) xdata_exp <- readMsExperiment(spectraFiles = fls[1:2], BPPARAM = SerialParam())  # Peak detection and grouping cwp <- CentWaveParam(peakwidth = c(5, 20), noise = 100) xdata_exp <- findChromPeaks(xdata_exp, param = cwp, BPPARAM = SerialParam()) pdp <- PeakDensityParam(sampleGroups = rep(1, 2), minFraction = 0.5) xdata_exp <- groupChromPeaks(xdata_exp, param = pdp)  # Create peak table without CAMERA peak_table_exp <- XCMSnExp_CAMERA_peaklist_long(xdata_exp) head(peak_table_exp) } # }"}]
